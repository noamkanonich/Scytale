<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scytale Home Assignment</title>

    <!-- BOOTSTRAP CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />

    <!-- BOOTSTRAP JS -->
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>

    <link rel="stylesheet" href="/css/style.css">

  </head>

  <body>
    <div class="text-center py-4">
      <h1>Add Pull Requests</h1>
    </div>

    <div class="d-flex justify-content-center">
      <form action="/prs" method="POST">
        <div class="form-row">
          <div class="form-group col-md-12">
            <label for="title">Title</label>
            <input
              type="text"
              name="title"
              class="form-control"
              id="title"
              placeholder="Title"
              required
            />
          </div>
        </div>
        <div class="form-group">
          <label for="description">Description</label>
          <textarea
            rows="4"
            type="text"
            name="description"
            class="form-control"
            id="description"
            placeholder="Write a description..."
            required
          ></textarea>
        </div>

        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="author">Author</label>
            <input type="text" name="author" class="form-control" id="author" required/>
          </div>
          <div class="form-group col-md-6">
            <label for="status">Status</label>
            <select id="status" name="status" class="form-control">
              <option selected>Choose...</option>
              <option value="Draft">Draft</option>
              <option value="Open">Open</option>
              <option value="Closed">Closed</option>
            </select>
          </div>
          <div class="form-group col-md-12">
            <label for="labels">Lables</label>
            <input type="text" name="labels" class="form-control" id="labels" required/>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Add User</button>
      </form>
    </div>

    <div class="container text-center py-4">
      <div>
        <table id="myTable" class="table">
          <thead>
            <tr>
              <th scope="col"><a onclick="sortTableByPrNumber()" style="color:black; text-decoration: none">PR Number</a></th>
              <th scope="col"><a onclick="sortTableByTitle()" style="color:black; text-decoration: none">Title</a></th>
              <th scope="col">Description</th>
              <th scope="col">Author</th>
              <th scope="col">Status</th>
              <th scope="col">Labels</th>
              <th scope="col">Creation Date</th>

            </tr>
          </thead>
      <% if(users) { %>
      <h1 class="py-4">Pull Requests List</h1>
      <% for(i=0 ; i < users.length ; i++) { %>
          <tbody>
            <tr>
              <th scope="row"><%= users[i].prNumber %></th>
              <td><%= users[i].title %></td>
              <td><%= users[i].description %></td>
              <td><%= users[i].author %></td>
              <td><%= users[i].status %></td>
              <td><%= users[i].labels %></td>
              <td><%= users[i].creationDate %></td>

            </tr>
          </tbody>
      <% } %>
       <% } %>
    </div>
  </table>

    <a href="/prs/delete">Delete All</a>
    </div>

    <script>
        function sortTableByTitle() {
        var table, rows, switching, i, x, y, shouldSwitch;
        table = document.getElementById("myTable");
        switching = true;
        while (switching) {
            switching = false;
            rows = table.rows;

            for (i = 1; i < (rows.length - 1); i++) {
                shouldSwitch = false;
                x = rows[i].getElementsByTagName("TD")[0];
                y = rows[i + 1].getElementsByTagName("TD")[0];
                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            }

            if (shouldSwitch) {
            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
            switching = true;
            }
        }
    }

    function sortTableByPrNumber() {
        var table, rows, switching, i, x, y, shouldSwitch;
        table = document.getElementById("myTable");
        switching = true;
        while (switching) {
            switching = false;
            rows = table.rows;

            for (i = 1; i < (rows.length - 1); i++) {
                shouldSwitch = false;
                x = rows[i].getElementsByTagName("TD")[0];
                y = rows[i + 1].getElementsByTagName("TD")[0];
                if ((x.innerHTML) < (y.innerHTML)) {
                    shouldSwitch = true;
                    break;
                    }
                }
                if (shouldSwitch) {
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                }
            }
        }
    </script>

  </body>
</html>
